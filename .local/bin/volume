#!/bin/sh

# Caminho do sink padrÃ£o
SINK=$(pactl info | awk -F': ' '/Default Sink/ {print $2}')
# SINK="@DEFAULT_SINK@"

# FunÃ§Ã£o para atualizar a barra (sinal 10 no dwmblocks)
update_bar() {
    pkill -RTMIN+10 dwmblocks 2>/dev/null
}
# Se for chamado com argumento, controla o volume
case "$1" in
    up)
        pactl set-sink-volume "$SINK" +5%
        update_bar
        exit
        ;;
    down)
        pactl set-sink-volume "$SINK" -5%
        update_bar
        exit
        ;;
    mute)
        pactl set-sink-mute "$SINK" toggle
        update_bar
        exit
        ;; 
esac

# Caso contrÃ¡rio, apenas exibe o volume (para o dwmblocks)
volstat="$(pactl list sinks)"

# Verifica mute
if echo "$volstat" | grep -q "Mute: yes"; then
    printf "ðŸ”‡ Mute\n"
    exit
fi

# ObtÃ©m o valor do volume (primeira ocorrÃªncia de %)
vol="$(echo "$volstat" | grep -o '[0-9]\+%' | head -n1 | tr -d '%')"

# Define Ã­cone de acordo com o nÃ­vel
if [ "$vol" -gt 70 ]; then
    icon="ðŸ”Š"
elif [ "$vol" -lt 30 ]; then
    icon="ðŸ”ˆ"
else
    icon="ðŸ”‰"
fi

printf "%s %s%%\n" "$icon" "$vol"
